<!--the main page for the music library website-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Music Library</title>
        <link rel="stylesheet" href="{{ url_for('static', filename= 'css/styles.css') }}">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" >
        <link rel="icon" type="image/png" href="favicon.png">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    </head>
    <body class="homeBody">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12" style="padding-top: 25px;">
                    <div class="text-center">
                        <h1 class="homeH1 rounded">Music Library</h1>
                    </div>
                    <div style="position: absolute; top: 10px; right: 10px; background-color: white; padding: 5px; border-radius: 5px;">
                        Environment: {{ env }}
                    </div>
                </div>
            </div>
            <div class="row mt-5">
                <form action="{{ url_for('home')}}">
                    <div class="input-group w-50 col-6 mx-auto">
                      <input type="text" class="form-control" placeholder="Search" id="search" name="search" value="{{search_term}}" autofocus 
                      onfocus="var val = this.value; this.value = ''; this.value = val;" 
                      onkeydown="if (event.key === 'Escape') { document.getElementById('search').value = ''; this.form.submit(); }">
                      <span>
                        <div class="input-group-text">
                            <button class="btn btn-default" type="submit">
                            <i class="bi bi-search"></i>
                            </button>
                        </div>
                      </span>
                      <div class="input-group-text">
                        <button class="btn btn-default" type="submit" onclick="document.getElementById('search').value = '';">
                            Reset (Esc)
                        </button>
                    </div>
                    </div>
                  </form>
            </div>
            <div class="d-flex justify-content-center align-items-center mt-2">
                {% if search_term %}
                    <p class="text-dark bg-light fw-bold rounded p-3 fs-4 d-inline-block me-3 mb-0">Songs Found: {{ song_list|length }}</p>
                {% else %}
                    <p class="text-dark bg-light fw-bold rounded p-3 fs-4 d-inline-block me-3 mb-0">Total Songs: {{ song_list|length }}</p>
                {% endif %}
                <a href="{{ url_for('Add_Song') }}" class="btn btn-primary fs-3"><i class="bi bi-plus-circle-fill fs-1"></i> Add a Song</a>
            </div>
            <br>

            <!--Display songs in table-->
            <div class="container-fluid"> 
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th>Action</th>
                            <th>Song name</th>
                            <th>Artist</th>
                            <th>Album</th>
                            <th>Song length</th>
                            <th>Genre</th>
                            <th>Release year</th>
                        </tr>
                    </thead>

                    <tbody>
                        <!--loop through song list-->
                        {% for song in song_list %}
                        <tr>
                            <td>
                                <a class="Link" href="{{ url_for('Edit_Song', ID=song.id) }}">Edit</a> | <form action="{{ url_for('song.delete_song', id=song.id) }}" method="post" style="display:inline;">
                                    <input type="hidden">
                                    <button type="submit" class="btn btn-link Link">Delete</button>
                                </form>
                            </td>
                            <td>{{song.song_name}}</td>
                            <td>{{song.artist}}</td>
                            <td>{{song.album}}</td>
                            <td>{{ song.song_length // 60 }}:{{ '%02d' % (song.song_length % 60) }}</td>
                            <td>{{song.genre}}</td>
                            <td>{{song.release_year}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </body>
</html>


